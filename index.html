<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Talão Ordem de Serviço</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
@page {
  size: A5;
  margin: 0;
}

body {
  background: #ccc;
  font-family: Arial, Helvetica, sans-serif;
}

#nota {
  width: 148mm;
  height: 210mm;
  background: #fff;
  margin: auto;
  padding: 8mm;
  box-sizing: border-box;
  border: 1px solid #000;
}

.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid #000;
  padding-bottom: 4px;
  margin-bottom: 4px;
}

.header img {
  height: 40px;
}

.header .titulo {
  text-align: right;
  font-size: 12px;
  font-weight: bold;
}

.linha {
  display: flex;
  font-size: 11px;
  margin-bottom: 3px;
}

.linha span {
  min-width: 70px;
}

input {
  border: none;
  border-bottom: 1px solid #000;
  font-size: 11px;
  width: 100%;
}

.tabela {
  width: 100%;
  border-collapse: collapse;
  font-size: 11px;
  margin-top: 4px;
}

.tabela th,
.tabela td {
  border: 1px solid #000;
  padding: 3px;
  text-align: center;
}

.tabela input {
  border: none;
  width: 100%;
  text-align: center;
}

.total-box {
  display: flex;
  justify-content: flex-end;
  font-size: 12px;
  margin-top: 5px;
}

.rodape {
  font-size: 10px;
  text-align: center;
  border-top: 1px solid #000;
  padding-top: 4px;
  margin-top: 6px;
}

.assinatura {
  margin-top: 15px;
  text-align: center;
  font-size: 10px;
}

.assinatura div {
  border-top: 1px solid #000;
  width: 60%;
  margin: auto;
}
</style>
</head>

<body>

<div id="nota">

  <!-- CABEÇALHO -->
  <div class="header">
    <img src="logo-jonas-bikes.png">
    <div class="titulo">
      TALÃO DE ORDEM DE SERVIÇO<br>
      DOCUMENTO A5
    </div>
  </div>

  <!-- DADOS -->
  <div class="linha">
    <span>Data:</span><input style="width:60px">
    <span style="margin-left:10px">Cliente:</span><input>
  </div>

  <div class="linha">
    <span>Endereço:</span><input>
  </div>

  <div class="linha">
    <span>CPF/CNPJ:</span><input style="width:120px">
    <span style="margin-left:10px">Fone:</span><input>
  </div>

  <!-- TABELA -->
  <table class="tabela">
    <thead>
      <tr>
        <th style="width:10%">QTD</th>
        <th style="width:50%">DESCRIÇÃO</th>
        <th style="width:20%">PREÇO UNIT</th>
        <th style="width:20%">TOTAL</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><input class="qtd"></td>
        <td><input></td>
        <td><input class="preco"></td>
        <td><input class="linhaTotal" readonly></td>
      </tr>
      <tr>
        <td><input class="qtd"></td>
        <td><input></td>
        <td><input class="preco"></td>
        <td><input class="linhaTotal" readonly></td>
      </tr>
      <tr>
        <td><input class="qtd"></td>
        <td><input></td>
        <td><input class="preco"></td>
        <td><input class="linhaTotal" readonly></td>
      </tr>
      <tr>
        <td><input class="qtd"></td>
        <td><input></td>
        <td><input class="preco"></td>
        <td><input class="linhaTotal" readonly></td>
      </tr>
    </tbody>
  </table>

  <!-- TOTAL -->
  <div class="total-box">
    <strong>TOTAL: R$ <span id="totalGeral">0,00</span></strong>
  </div>

  <!-- RODAPÉ -->
  <div class="rodape">
    RECIBO DE VENDA<br>
    (17) 99755-2141 · Av. Arapuã, 2815 – Jardim Santo Expedito<br>
    @jonas_bikes_jales
  </div>

  <div class="assinatura">
    <div></div>
    Assinatura da Loja
  </div>

</div>

<button onclick="gerarPDF()" style="display:block;margin:15px auto;">
  Gerar PDF
</button>

<script>
function calcular() {
  let total = 0;

  document.querySelectorAll("tbody tr").forEach(tr => {
    const qtd = parseFloat(tr.querySelector(".qtd").value) || 0;
    const preco = parseFloat(tr.querySelector(".preco").value) || 0;
    const soma = qtd * preco;

    tr.querySelector(".linhaTotal").value = soma.toFixed(2);
    total += soma;
  });

  document.getElementById("totalGeral").innerText = total.toFixed(2);
}

document.addEventListener("input", calcular);

function gerarPDF() {
  html2pdf().set({
    margin: 0,
    filename: 'talão-ordem-servico-jonas-bikes.pdf',
    html2canvas: { scale: 2 },
    jsPDF: { unit: 'mm', format: 'a5', orientation: 'portrait' }
  }).from(document.getElementById("nota")).save();
}
</script>

</body>
</html>
